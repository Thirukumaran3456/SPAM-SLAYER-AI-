import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.svm import SVC
from sklearn.pipeline import Pipeline
from sklearn.metrics import accuracy_score

# 1. Dummy Dataset Creation (For demonstration)
# In practice, load a CSV: df = pd.read_csv("spam_data.csv")
data = {
    'text': [
        'Win a free cash prize now!', 'Meeting at 3pm tomorrow',
        'Urgent: Claim your prize', 'Hey, are we still on for lunch?',
        'Get cheap loans with low interest', 'Project deadline is Friday'
    ],
    'spam': [1, 0, 1, 0, 1, 0] # 1: Spam, 0: Ham
}
df = pd.DataFrame(data)

# 2. Split Data
X = df['text']
y = df['spam']
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# 3. Create a Pipeline: Text Vectorization + Model Training
# CountVectorizer converts text to numbers, SVM classifies them
model = Pipeline([
    ('vectorizer', CountVectorizer()),
    ('classifier', SVC(kernel='linear'))
])

# 4. Train the model
model.fit(X_train, y_train)

# 5. Evaluate
y_pred = model.predict(X_test)
print(f"Model Accuracy: {accuracy_score(y_test, y_pred) * 100:.2f}%")

# 6. Test with new, unseen emails
new_emails = [
    "URGENT: Your account is locked, click here",
    "Please review the attached invoice"
]
predictions = model.predict(new_emails)

for email, pred in zip(new_emails, predictions):
    label = "SPAM" if pred == 1 else "HAM"
    print(f"Email: '{email}' -> Predicted: {label}")
